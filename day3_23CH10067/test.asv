clc;
clear all;


%% SOLUTION FOR ODE
% tspan = [0 20];
% y0 = [1;350];
 
% function dydt = odefun(t,y)
% k = 0.3;
% alpha = 0.2;
% Ta = 300;

% dydt = zeros(2,1);
% dydt(1) = -k*y(1);
% dydt(2) = -alpha * (y(2)-Ta);
% end

% [t,y] = ode45(@odefun, tspan, y0);

% figure;
% plot(t,y(:,1), 'r');
% hold on;
% plot(t, y(:,2), 'b');
% hold on;

%% SOLUTION FOR PDE (FINITE DIFF METHOD)

L = 1;
alpha = 0.01;
Nx = 20;
dx = L/(Nx-1);
x = linespace(0, L, Nx);

Nt = 500;
dt = 0.001;
t = 0:dt:Nt*dt;
r = alpha* dt/dx^2;
T = sin(pi*x);
T(1) = 0;
T(end) = 0;

for n=1:Nt
    T_old = T;
    for i=2:Nx-1
        T(i) = T_old(i) r * (T_old(i+1) - 2*T_old(i) + T_old(i-1));
    end
end

plot(x,T);
xlabel('x');
ylabel('T');
